
    select s.R_TIME,s.TEMPERATURE_COL,(
      case when s.TEMPERATURE_COL='R_ANALOG1' then s.R_ANALOG1 else s.R_ANALOG2
      end) as R_ANALOG,s.TRUCK_NAME,s.TEMPERATURE_COL,s.TRUCK_LICENSE from (select R_TIME,
      (case when R_ANALOG1<1000 then R_ANALOG1 - (127) else (R_ANALOG1-12700)/100 end) AS R_ANALOG1,
      (case when R_ANALOG2<1000 then R_ANALOG2 - (127) else (R_ANALOG2-12700)/100 end) AS R_ANALOG2,TRUCK.TRUCK_NAME,TRUCK.TRUCK_LICENSE,
      CASE WHEN TRUCK.TEMPERATURE_COL IS NULL THEN 'R_ANALOG1' ELSE TRUCK.TEMPERATURE_COL END AS TEMPERATURE_COL from z010197700000500Data 
      left join BLACKBOX on BLACKBOX.BLACKBOX_ID = '010197700000500'
      left join TRUCK on BLACKBOX.TRUCK_ID = TRUCK.TRUCK_ID) as s
      where R_TIME >= '2019-04-07 10:10:21' AND R_TIME <= '2019-04-07 13:46:06' ORDER BY R_TIME ASC
  